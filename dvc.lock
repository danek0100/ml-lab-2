schema: '2.0'
stages:
  data_processing:
    cmd: python -m src.data.make_dataset OUTPUT_TARGET_FILEPATH=.
    deps:
    - path: data/raw/test.csv
      md5: df398776b248dc067500bd4ee8fd432f
      size: 452863
    - path: data/raw/train.csv
      md5: 6d98f248d32b04638250825193b64c81
      size: 462135
    - path: src/config.py
      md5: 72dd2a887879e7187a65d779798e8bae
      size: 2260
    - path: src/data/make_dataset.py
      md5: 48a027de4a6b8d3d94c42c8e7a2d2ce7
      size: 2200
    - path: src/data/preprocess.py
      md5: 0426c113f2c47e63ff5bf53c20c67eb2
      size: 3585
    - path: src/utils.py
      md5: a63e9fc88f67423ded9b88dcd49a34f6
      size: 387
    params:
      params.yaml:
        data_load:
          train_csv: data/raw/train.csv
          test_csv: data/raw/test.csv
        interim_paths:
          data_for_train_pkl: data/interim/data_for_train.pkl
          val_pkl: data/interim/val.pkl
        preprocess_category:
          TARGET_COL:
          - SalePrice
          ID_COL: Id
          CAT_COLS:
          - MSZoning
          - Street
          - Alley
          - LotShape
          - LandContour
          - Utilities
          - LotConfig
          - LandSlope
          - Neighborhood
          - Condition1
          - Condition2
          - BldgType
          - HouseStyle
          - RoofStyle
          - RoofMatl
          - Exterior1st
          - Exterior2nd
          - MasVnrType
          - ExterQual
          - ExterCond
          - Foundation
          - BsmtQual
          - BsmtCond
          - BsmtExposure
          - BsmtFinType1
          - BsmtFinType2
          - Heating
          - HeatingQC
          - CentralAir
          - Electrical
          - KitchenQual
          - Functional
          - FireplaceQu
          - GarageType
          - GarageFinish
          - GarageQual
          - GarageCond
          - PavedDrive
          - PoolQC
          - Fence
          - MiscFeature
          - SaleType
          - SaleCondition
          REAL_COLS:
          - MSSubClass
          - OverallQual
          - OverallCond
          - LotFrontage
          - LotArea
          - MasVnrArea
          - BsmtFinSF1
          - BsmtFinSF2
          - BsmtUnfSF
          - TotalBsmtSF
          - 1stFlrSF
          - 2ndFlrSF
          - LowQualFinSF
          - GrLivArea
          - BsmtFullBath
          - BsmtHalfBath
          - FullBath
          - HalfBath
          - BedroomAbvGr
          - KitchenAbvGr
          - TotRmsAbvGrd
          - Fireplaces
          - GarageCars
          - GarageArea
          - WoodDeckSF
          - OpenPorchSF
          - EnclosedPorch
          - 3SsnPorch
          - ScreenPorch
          - PoolArea
          - MiscVal
          DATA_COLS:
          - YearBuilt
          - YearRemodAdd
          - GarageYrBlt
          - MoSold
          - YrSold
          BASEMENT_COLS:
          - BsmtCond
          - BsmtExposure
          - BsmtFinType1
          - BsmtFinType2
          MASONRY_COLS:
          - MasVnrArea
          GARAGE_COLS:
          - GarageFinish
          - GarageQual
          - GarageCond
          GARAGE_COL:
          - GarageYrBlt
          MAX_NUMBER_NAN_VALUE_COLS:
          - PoolQC
          - Fence
          - MiscFeature
          - Alley
          - BsmtQual
          - GarageType
          - FireplaceQu
          NUMBER_OF_TEST: 15
        processed_paths:
          target_data_train_pkl: data/processed/target_for_data_for_train.pkl
          processed_test_pkl: data/processed/test.pkl
          processed_data_for_train_pkl: data/processed/data_for_train.pkl
    outs:
    - path: data/interim/data_for_train.pkl
      md5: b430e70fcce686bc00551b880c02121b
      size: 294962
    - path: data/interim/val.pkl
      md5: c136026b70acecece648ba3328f59473
      size: 294201
    - path: data/processed/target_for_data_for_train.pkl
      md5: 15d43e1a36d278ad465c932f989d34de
      size: 18243
  feature_generation:
    cmd: python -m src.features.build_features
    deps:
    - path: data/interim/data_for_train.pkl
      md5: b430e70fcce686bc00551b880c02121b
      size: 294962
    - path: data/interim/val.pkl
      md5: c136026b70acecece648ba3328f59473
      size: 294201
    - path: src/config.py
      md5: 72dd2a887879e7187a65d779798e8bae
      size: 2260
    - path: src/features/build_features.py
      md5: c6536bd9320feae4b84963055ba5de94
      size: 1124
    - path: src/features/functions.py
      md5: 781cf53992fdd21995c0eb98d673f7a1
      size: 6300
    - path: src/utils.py
      md5: a63e9fc88f67423ded9b88dcd49a34f6
      size: 387
    params:
      params.yaml:
        interim_paths:
          data_for_train_pkl: data/interim/data_for_train.pkl
          val_pkl: data/interim/val.pkl
        preprocess_category:
          TARGET_COL:
          - SalePrice
          ID_COL: Id
          CAT_COLS:
          - MSZoning
          - Street
          - Alley
          - LotShape
          - LandContour
          - Utilities
          - LotConfig
          - LandSlope
          - Neighborhood
          - Condition1
          - Condition2
          - BldgType
          - HouseStyle
          - RoofStyle
          - RoofMatl
          - Exterior1st
          - Exterior2nd
          - MasVnrType
          - ExterQual
          - ExterCond
          - Foundation
          - BsmtQual
          - BsmtCond
          - BsmtExposure
          - BsmtFinType1
          - BsmtFinType2
          - Heating
          - HeatingQC
          - CentralAir
          - Electrical
          - KitchenQual
          - Functional
          - FireplaceQu
          - GarageType
          - GarageFinish
          - GarageQual
          - GarageCond
          - PavedDrive
          - PoolQC
          - Fence
          - MiscFeature
          - SaleType
          - SaleCondition
          REAL_COLS:
          - MSSubClass
          - OverallQual
          - OverallCond
          - LotFrontage
          - LotArea
          - MasVnrArea
          - BsmtFinSF1
          - BsmtFinSF2
          - BsmtUnfSF
          - TotalBsmtSF
          - 1stFlrSF
          - 2ndFlrSF
          - LowQualFinSF
          - GrLivArea
          - BsmtFullBath
          - BsmtHalfBath
          - FullBath
          - HalfBath
          - BedroomAbvGr
          - KitchenAbvGr
          - TotRmsAbvGrd
          - Fireplaces
          - GarageCars
          - GarageArea
          - WoodDeckSF
          - OpenPorchSF
          - EnclosedPorch
          - 3SsnPorch
          - ScreenPorch
          - PoolArea
          - MiscVal
          DATA_COLS:
          - YearBuilt
          - YearRemodAdd
          - GarageYrBlt
          - MoSold
          - YrSold
          BASEMENT_COLS:
          - BsmtCond
          - BsmtExposure
          - BsmtFinType1
          - BsmtFinType2
          MASONRY_COLS:
          - MasVnrArea
          GARAGE_COLS:
          - GarageFinish
          - GarageQual
          - GarageCond
          GARAGE_COL:
          - GarageYrBlt
          MAX_NUMBER_NAN_VALUE_COLS:
          - PoolQC
          - Fence
          - MiscFeature
          - Alley
          - BsmtQual
          - GarageType
          - FireplaceQu
          NUMBER_OF_TEST: 15
        processed_paths:
          target_data_train_pkl: data/processed/target_for_data_for_train.pkl
          processed_test_pkl: data/processed/test.pkl
          processed_data_for_train_pkl: data/processed/data_for_train.pkl
    outs:
    - path: data/processed/data_for_train.pkl
      md5: 6e68ce72ea4f737b547b647090b1709e
      size: 306802
    - path: data/processed/test.pkl
      md5: d7db0a21bb6f2e7356cbb572972052cd
      size: 305648
  train:
    cmd: python -m src.models.train_model
    deps:
    - path: data/processed/data_for_train.pkl
      md5: 6e68ce72ea4f737b547b647090b1709e
      size: 306802
    - path: data/processed/test.pkl
      md5: d7db0a21bb6f2e7356cbb572972052cd
      size: 305648
    - path: src/config.py
      md5: 72dd2a887879e7187a65d779798e8bae
      size: 2260
    - path: src/models/functions.py
      md5: 1f0621813b9d2e510a67b7ff66c91889
      size: 756
    - path: src/models/train_model.py
      md5: 517aa87e8353c196de3c17e8b58361e9
      size: 2704
    params:
      params.yaml:
        processed_paths:
          target_data_train_pkl: data/processed/target_for_data_for_train.pkl
          processed_test_pkl: data/processed/test.pkl
          processed_data_for_train_pkl: data/processed/data_for_train.pkl
        train:
          test_size: 0.2
          iterations: 15
          loss_function: RMSE
          learning_rate: 0.2
          ctr_leaf_count_limit: 20
          max_depth: 4
          booster: dart
          eta: 0.2
          tree_method: exact
          random_state: 77
          model_catboost_path: models/model_catboost.joblib
          model_xgboost_path: models/model_xgboost.joblib
          X_test_path: data/processed/X_test_data.pkl
          Y_test_path: data/processed/Y_test_data.pkl
    outs:
    - path: catboost_info/learn_error.tsv
      md5: b0a06c26bcef84328887987ddd4f68d8
      size: 225
    - path: data/processed/X_test_data.pkl
      md5: a27d0e0b10ffb1efca9f28b1a4668724
      size: 70228
    - path: data/processed/Y_test_data.pkl
      md5: f357627b4d56172b23a74a52bd6d7787
      size: 4263
    - path: models/model_catboost.joblib
      md5: 574597669f6906deb5e60dbc562987b7
      size: 17952
    - path: models/model_xgboost.joblib
      md5: 5db0a9dd3d61976ce5a215bb53186280
      size: 437446
  evaluate:
    cmd: python -m src.models.predict_model
    deps:
    - path: data/processed/X_test_data.pkl
      md5: a27d0e0b10ffb1efca9f28b1a4668724
      size: 70228
    - path: data/processed/Y_test_data.pkl
      md5: f357627b4d56172b23a74a52bd6d7787
      size: 4263
    - path: models/model_catboost.joblib
      md5: 574597669f6906deb5e60dbc562987b7
      size: 17952
    - path: models/model_xgboost.joblib
      md5: 5db0a9dd3d61976ce5a215bb53186280
      size: 437446
    - path: src/config.py
      md5: 72dd2a887879e7187a65d779798e8bae
      size: 2260
    - path: src/models/functions.py
      md5: 1f0621813b9d2e510a67b7ff66c91889
      size: 756
    - path: src/models/predict_model.py
      md5: 17b97e51c53b93eb55b41586a6d3fe65
      size: 798
    - path: src/models/train_model.py
      md5: 517aa87e8353c196de3c17e8b58361e9
      size: 2704
    params:
      params.yaml:
        evaluate:
          score_metric: f1
          score_path_catboost: reports/metrics_catboost.json
          score_path_xgboost: reports/metrics_xgboost.json
          score_path_rocauc_samples_catboost: reports/metrics_rocauc_catboost.csv
          score_path_rocauc_samples_lgbm: reports/metrics_rocauc_lgbm.csv
        train:
          test_size: 0.2
          iterations: 15
          loss_function: RMSE
          learning_rate: 0.2
          ctr_leaf_count_limit: 20
          max_depth: 4
          booster: dart
          eta: 0.2
          tree_method: exact
          random_state: 77
          model_catboost_path: models/model_catboost.joblib
          model_xgboost_path: models/model_xgboost.joblib
          X_test_path: data/processed/X_test_data.pkl
          Y_test_path: data/processed/Y_test_data.pkl
    outs:
    - path: reports/metrics_catboost.json
      md5: 7c16576972277340e45778120d079923
      size: 108
    - path: reports/metrics_xgboost.json
      md5: e134b0a6a1414d77938c385d7ddadc7f
      size: 107
  inference:
    cmd: python -m src.inference.inference DATA_FILEPATH=data/raw/test.csv
    deps:
    - path: data/raw/test.csv
      md5: df398776b248dc067500bd4ee8fd432f
      size: 452863
    - path: models/model_catboost.joblib
      md5: 574597669f6906deb5e60dbc562987b7
      size: 17952
    - path: models/model_xgboost.joblib
      md5: 5db0a9dd3d61976ce5a215bb53186280
      size: 437446
    - path: src/config.py
      md5: 72dd2a887879e7187a65d779798e8bae
      size: 2260
    - path: src/inference/inference.py
      md5: 66ac64738ef5581ace05aed268a5a410
      size: 1841
    params:
      params.yaml:
        train:
          test_size: 0.2
          iterations: 15
          loss_function: RMSE
          learning_rate: 0.2
          ctr_leaf_count_limit: 20
          max_depth: 4
          booster: dart
          eta: 0.2
          tree_method: exact
          random_state: 77
          model_catboost_path: models/model_catboost.joblib
          model_xgboost_path: models/model_xgboost.joblib
          X_test_path: data/processed/X_test_data.pkl
          Y_test_path: data/processed/Y_test_data.pkl
